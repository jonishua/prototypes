{
  "project": {
    "name": "Idle Garden Reborn (Web)",
    "runtime": "browser",
    "description": "Hybrid tap + grow idle game using Party, Party, Party currencies (Credits, Tickets, Gems). Central tappable flower with crits, surrounding idle plots, boosters spent with Tickets."
  },
  "instructions": [
    "Open index.html in a browser.",
    "Tap the central flower to earn Credits (crits may drop Tickets/Gems).",
    "Plant seeds in surrounding plots; harvest to earn more Credits (and occasional Tickets/Gems).",
    "Use Tickets to trigger temporary Boosters; buy upgrades/decor to scale.",
    "Progress saves to localStorage; Reset via Settings."
  ],
  "files": [
    {
      "path": "index.html",
      "contents": "<!doctype html>\n<html lang=\"en\">\n<head>\n  <meta charset=\"utf-8\"/>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, viewport-fit=cover\"/>\n  <title>Idle Garden Reborn</title>\n  <link rel=\"stylesheet\" href=\"style.css\"/>\n</head>\n<body>\n  <div class=\"app\">\n    <header class=\"topbar\">\n      <div class=\"brand\">\ud83c\udf38 Idle Garden Reborn</div>\n      <div class=\"wallets\">\n        <div class=\"pill\">\ud83d\udcb0 <span id=\"credits\">0</span></div>\n        <div class=\"pill\">\ud83c\udf9f\ufe0f <span id=\"tickets\">0</span></div>\n        <div class=\"pill\">\ud83d\udc8e <span id=\"gems\">0</span></div>\n      </div>\n      <button id=\"btnSettings\" class=\"icon-btn\" aria-label=\"Settings\">\u2699\ufe0f</button>\n    </header>\n\n    <main class=\"playfield\">\n      <div id=\"garden\" class=\"garden\" aria-label=\"Garden\">\n        <!-- 3x3 layout: center is the Flower, others are Plots -->\n        <div class=\"cell\" data-kind=\"plot\" data-idx=\"0\"></div>\n        <div class=\"cell\" data-kind=\"plot\" data-idx=\"1\"></div>\n        <div class=\"cell\" data-kind=\"plot\" data-idx=\"2\"></div>\n        <div class=\"cell\" data-kind=\"plot\" data-idx=\"3\"></div>\n        <button id=\"flower\" class=\"flower\" data-kind=\"flower\" aria-label=\"Central Flower\">\n          <div class=\"combo\" id=\"comboMeter\"></div>\n          <div class=\"spr\">\ud83c\udf37</div>\n        </button>\n        <div class=\"cell\" data-kind=\"plot\" data-idx=\"4\"></div>\n        <div class=\"cell\" data-kind=\"plot\" data-idx=\"5\"></div>\n        <div class=\"cell\" data-kind=\"plot\" data-idx=\"6\"></div>\n        <div class=\"cell\" data-kind=\"plot\" data-idx=\"7\"></div>\n      </div>\n    </main>\n\n    <nav class=\"dock\">\n      <button class=\"dock-btn active\" data-tab=\"seeds\">\ud83c\udf30 Seeds</button>\n      <button class=\"dock-btn\" data-tab=\"upgrades\">\ud83e\uddea Upgrades</button>\n      <button class=\"dock-btn\" data-tab=\"decor\">\ud83e\uddda Decor</button>\n      <button class=\"dock-btn\" data-tab=\"boosters\">\u26a1 Boosters</button>\n    </nav>\n\n    <section class=\"tray\">\n      <div id=\"panel-seeds\" class=\"panel active\"></div>\n      <div id=\"panel-upgrades\" class=\"panel\"></div>\n      <div id=\"panel-decor\" class=\"panel\"></div>\n      <div id=\"panel-boosters\" class=\"panel\"></div>\n    </section>\n  </div>\n\n  <dialog id=\"seedPicker\">\n    <h3>Choose a seed</h3>\n    <div id=\"seedPickerList\" class=\"picker-list\"></div>\n    <form method=\"dialog\">\n      <button>Cancel</button>\n    </form>\n  </dialog>\n\n  <dialog id=\"settings\">\n    <h3>Settings</h3>\n    <button id=\"resetBtn\" class=\"danger\">Reset Save</button>\n    <form method=\"dialog\">\n      <button>Close</button>\n    </form>\n  </dialog>\n\n  <template id=\"tpl-plot\">\n    <button class=\"plot\" aria-label=\"Empty plot\">\n      <div class=\"lock\">\ud83d\udd12</div>\n      <div class=\"spr\"></div>\n      <div class=\"bar\"><span></span></div>\n      <div class=\"halo\"></div>\n    </button>\n  </template>\n\n  <script src=\"main.js\"></script>\n</body>\n</html>\n"
    },
    {
      "path": "style.css",
      "contents": ":root{--bg:#f6f7f9;--card:#fff;--soft:#e8ecf2;--ink:#1b1f23;--acc:#7cc37c;--rare:#8ec8ff;--epic:#b494ff;--leg:#ffde66}\n*{box-sizing:border-box}\nhtml,body{height:100%;margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}\nbody{padding:env(safe-area-inset-top) env(safe-area-inset-right) calc(16px + env(safe-area-inset-bottom)) env(safe-area-inset-left)}\n.app{max-width:430px;margin:0 auto;display:flex;flex-direction:column;min-height:100dvh}\n.topbar{display:flex;align-items:center;gap:12px;justify-content:space-between;padding:12px 14px;background:var(--card);border-radius:16px;box-shadow:0 2px 8px rgba(0,0,0,.06)}\n.brand{font-weight:700}\n.wallets{display:flex;gap:8px}\n.pill{background:#0000;border:1px solid var(--soft);border-radius:999px;padding:6px 10px;font-variant-numeric:tabular-nums}\n.icon-btn{border:0;background:transparent;font-size:20px}\n.playfield{flex:1;display:grid;place-items:center;padding:12px}\n.garden{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;background:linear-gradient(180deg,#eaf4ea,#eef5f0);padding:12px;border-radius:16px;box-shadow:inset 0 0 0 1px var(--soft)}\n.cell{width:92px;height:92px}\n.plot{width:100%;height:100%;border-radius:14px;border:1px solid var(--soft);background:linear-gradient(180deg,#cfe9cf,#bfe0bf);position:relative;overflow:hidden}\n.plot .lock{position:absolute;inset:auto auto 6px 6px;font-size:14px;opacity:.8}\n.plot.locked{filter:grayscale(.7) contrast(.9)}\n.plot .spr{position:absolute;inset:0;display:grid;place-items:center;font-size:22px}\n.plot .bar{position:absolute;left:6px;right:6px;bottom:6px;height:6px;background:#0002;border-radius:6px;overflow:hidden}\n.plot .bar span{display:block;height:100%;width:0;background:var(--acc)}\n.plot.ready{animation:pulse .9s infinite alternate}\n@keyframes pulse{to{box-shadow:0 0 0 3px #fff8,0 0 0 6px #fff4}}\n.plot .halo{position:absolute;inset:-2px;border-radius:12px;pointer-events:none}\n.halo.rare{box-shadow:0 0 12px 2px var(--rare)}\n.halo.epic{box-shadow:0 0 14px 3px var(--epic)}\n.halo.legend{box-shadow:0 0 16px 4px var(--leg)}\n.flower{width:92px;height:92px;border-radius:999px;border:1px solid var(--soft);background:linear-gradient(180deg,#ffe7f0,#ffd7ea);position:relative;display:grid;place-items:center}\n.flower:active{transform:scale(.98)}\n.flower .spr{font-size:28px}\n.combo{position:absolute;inset:6px;border-radius:999px;border:3px solid #0002}\n.combo.fill{border-color:#0006}\n.dock{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;padding:8px 12px}\n.dock-btn{background:var(--card);border:1px solid var(--soft);border-radius:12px;padding:10px;font-weight:600}\n.dock-btn.active{outline:3px solid #0001}\n.tray{background:var(--card);border-top:1px solid var(--soft);padding:8px 12px;border-radius:16px}\n.panel{display:none;gap:8px;grid-template-columns:repeat(3,1fr)}\n.panel.active{display:grid}\n.card{background:var(--bg);border:1px solid var(--soft);border-radius:12px;padding:10px}\n.card h4{margin:0 0 4px 0}\n.card .meta{font-size:12px;color:#6b7480}\nbutton.buy{margin-top:6px;width:100%;border-radius:10px;border:1px solid var(--soft);background:var(--card);padding:8px}\n#seedPicker::backdrop,#settings::backdrop{background:#0006}\n.picker-list{display:grid;gap:8px}\n.danger{background:#ffecec;border:1px solid #ffb4b4;border-radius:10px;padding:8px}\n.popup{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);background:#fff;padding:2px 6px;border-radius:8px;box-shadow:0 2px 6px #0002;font-weight:700}\n.crit{color:#b3134a}\n"
    },
    {
      "path": "main.js",
      "contents": "/* Idle Garden Reborn (Web) \u2013 PPP currencies, crits, boosters, central flower */\nconst $=s=>document.querySelector(s), $$=s=>Array.from(document.querySelectorAll(s));\n\n// --- DATA -----------------------------------------------------------------\nconst DATA={\n  rarity:[\n    {key:'common',w:70,m:1,a:''},\n    {key:'rare',w:20,m:2,a:'rare'},\n    {key:'epic',w:8,m:4,a:'epic'},\n    {key:'legend',w:2,m:8,a:'legend'}\n  ],\n  seeds:[\n    {id:'daisy',name:'Daisy',cost:50,grow:15,yield:40,spr:'\ud83c\udf3c'},\n    {id:'rose',name:'Rose',cost:250,grow:30,yield:200,spr:'\ud83c\udf39'},\n    {id:'orchid',name:'Orchid',cost:1000,grow:90,yield:900,spr:'\ud83e\udeb7'},\n    {id:'sunlotus',name:'Sun Lotus',cost:2500,grow:300,yield:3000,spr:'\ud83c\udf3b'}\n  ],\n  upgrades:{\n    tapPower:{name:'Tap Power +1',base:100,scale:2},\n    critChance:{name:'+1% Crit',base:500,scale:1.5},\n    critMult:{name:'+2x Crit Mult',base:1000,scale:2}\n  },\n  decor:[\n    {id:'gnome',name:'Gnome of Fortune',currency:'gems',cost:250,type:'critChance',val:0.05,spr:'\ud83e\uddd9'},\n    {id:'bush',name:'Butterfly Shrine',currency:'credits',cost:1000,type:'growSpeed',val:0.10,spr:'\ud83e\udd8b'},\n    {id:'fountain',name:'Crystal Fountain',currency:'credits',cost:5000,type:'tapYield',val:0.10,spr:'\u26f2'}\n  ],\n  boosters:[\n    {id:'bloom',name:'Bloom Burst',tickets:25,dur:30,effects:{tapPower:0.5,critChance:0.02}},\n    {id:'seedrush',name:'Seed Rush',tickets:20,dur:60,effects:{growSpeed:0.30}},\n    {id:'fortune',name:'Fortune Aura',tickets:40,dur:45,effects:{rarityWeight:0.50}},\n    {id:'golden',name:'Golden Popups',tickets:30,dur:30,effects:{globalCredits:0.25}}\n  ]\n};\n\n// --- STATE ----------------------------------------------------------------\nconst state={\n  credits:100, tickets:0, gems:0,\n  tap:{power:1, critChance:0.05, critMult:10, combo:0, comboBonus:0},\n  grid:Array(8).fill(0).map((_,i)=>({locked:i>3,seed:null,plantedAt:0,grow:0,ready:false,aura:''})),\n  upgrades:{tapPower:0,critChance:0,critMult:0},\n  decor:[],\n  boosters:{},\n  harvestsThisSession:0\n};\n\nfunction save(){localStorage.setItem('igr-save',JSON.stringify(state));}\nfunction load(){const s=localStorage.getItem('igr-save'); if(s){try{Object.assign(state,JSON.parse(s));}catch(e){}}}\n\n// --- UTILS ---------------------------------------------------------------\nfunction seedById(id){return DATA.seeds.find(s=>s.id===id);} \nfunction rollRarity(extra){const pool=DATA.rarity.map((r,i)=>({...r,w:i>0?r.w*(1+extra):r.w}));const tot=pool.reduce((a,b)=>a+b.w,0);let t=Math.random()*tot;for(const r of pool){t-=r.w; if(t<=0) return r;}return pool[0];}\nfunction activeBoost(id){return state.boosters[id] && state.boosters[id]>Date.now()/1000;}\nfunction boostVal(key){let v=0; for(const b of DATA.boosters){ if(activeBoost(b.id) && b.effects[key]) v+=b.effects[key]; } return v; }\n\n// decor simple aggregation\nfunction decorVal(key){let v=0; for(const d of state.decor){ if(d.type===key) v+=d.val; } return v; }\n\n// --- UI HOOKS ------------------------------------------------------------\nconst creditsEl=$('#credits'), ticketsEl=$('#tickets'), gemsEl=$('#gems');\nconst gardenEl=$('#garden'); const flowerEl=$('#flower'); const comboEl=$('#comboMeter');\n\nfunction refreshTop(){creditsEl.textContent=state.credits.toLocaleString();ticketsEl.textContent=state.tickets.toLocaleString();gemsEl.textContent=state.gems.toLocaleString();}\n\nfunction buildPlots(){\n  // build each plot cell content\n  const cells=$$('.cell[data-kind=\"plot\"]');\n  cells.forEach((cell,i)=>{\n    if(!cell.firstChild){\n      const btn=document.importNode($('#tpl-plot').content,true).firstElementChild;\n      btn.dataset.idx=i; cell.appendChild(btn);\n      btn.addEventListener('click', onPlotTap);\n    }\n  });\n}\n\nfunction renderPlot(i){\n  const cellEl=$(`.plot[data-idx=\"${i}\"]`);\n  const cell=state.grid[i];\n  if(!cellEl||!cell) return;\n  const spr=cellEl.querySelector('.spr');\n  const bar=cellEl.querySelector('.bar span');\n  const halo=cellEl.querySelector('.halo');\n  cellEl.classList.toggle('locked', !!cell.locked);\n  if(cell.seed){\n    const sdef=seedById(cell.seed);\n    spr.textContent=sdef.spr;\n    const pct=Math.min(1,(performance.now()/1000-cell.plantedAt)/cell.grow);\n    bar.style.width=(pct*100).toFixed(1)+'%';\n    cellEl.classList.toggle('ready', pct>=1);\n    cell.ready=pct>=1;\n  } else {\n    spr.textContent=''; bar.style.width='0%'; cell.ready=false; cellEl.classList.remove('ready');\n  }\n  halo.className='halo '+(cell.aura||'');\n}\n\nfunction renderAll(){ refreshTop(); for(let i=0;i<state.grid.length;i++) renderPlot(i); renderCombo(); }\n\nfunction renderCombo(){\n  const max=50; const pct=Math.min(1, state.tap.combo/max);\n  comboEl.style.background=`conic-gradient(#0006 ${pct*360}deg, #0001 0)`;\n}\n\n// --- INTERACTION ---------------------------------------------------------\nfunction onPlotTap(e){\n  const idx=+e.currentTarget.dataset.idx; const cell=state.grid[idx];\n  if(cell.locked){ const cost=200*(idx+1); if(state.credits>=cost){ state.credits-=cost; cell.locked=false; save(); renderAll(); } return; }\n  if(!cell.seed){ openSeedPicker(idx); return; }\n  if(cell.ready){ harvest(idx); return; }\n  // if growing: tap haste (2%)\n  const now=performance.now()/1000; const remain=Math.max(0, (cell.plantedAt+cell.grow)-now); const shaved=0.02*cell.grow; const newGrow=Math.max(0, remain - shaved); cell.grow=(now - cell.plantedAt) + newGrow; }\n\nfunction openSeedPicker(idx){ const dlg=$('#seedPicker'); const list=$('#seedPickerList'); list.innerHTML=''; DATA.seeds.forEach(s=>{ const b=document.createElement('button'); b.className='card'; b.innerHTML=`<h4>${s.spr} ${s.name}</h4><div class=\"meta\">${s.cost}\ud83d\udcb0 \u00b7 ${s.grow}s \u00b7 y${s.yield}</div>`; b.onclick=()=>{ if(state.credits<s.cost) return; state.credits-=s.cost; const effGrow= Math.max(.5, s.grow * (1 - (decorVal('growSpeed') + boostVal('growSpeed')))); state.grid[idx]={...state.grid[idx], seed:s.id, plantedAt:performance.now()/1000, grow: effGrow, aura:''}; save(); renderAll(); dlg.close(); }; list.appendChild(b); }); dlg.showModal(); }\n\nfunction harvest(idx){\n  const cell=state.grid[idx]; const sdef=seedById(cell.seed);\n  const now=performance.now()/1000; const ready=(now - cell.plantedAt)>=cell.grow; if(!ready) return;\n  // rarity roll with boosters\n  const r=rollRarity(boostVal('rarityWeight'));\n  // base + decor tapYield also adds to harvest a bit (3%)\n  let payout=Math.round(sdef.yield * r.m * (1 + decorVal('tapYield')*0.3) * (1 + boostVal('globalCredits')));\n  state.credits+=payout; state.harvestsThisSession=(state.harvestsThisSession||0)+1;\n  // rare gem drops by seed tier (simple):\n  if(sdef.id==='rose' && Math.random()<0.005) state.gems+=1;\n  if(sdef.id==='orchid' && Math.random()<0.01) state.gems+=1+Math.floor(Math.random()*2);\n  if(sdef.id==='sunlotus' && Math.random()<0.02) state.gems+=2+Math.floor(Math.random()*2);\n  // milestone tickets every 10 harvests\n  if(state.harvestsThisSession%10===0) state.tickets+=3;\n  // popup\n  const el=$(`.plot[data-idx=\"${idx}\"]`); const pop=document.createElement('div'); pop.className='popup'; pop.textContent=`+${payout}`; el.appendChild(pop); setTimeout(()=>pop.remove(),800);\n  state.grid[idx]={...cell, seed:null, plantedAt:0,grow:0,ready:false,aura:r.a}; save(); renderAll();\n}\n\n// --- CENTRAL FLOWER (TAP) -----------------------------------------------\nflowerEl.addEventListener('click',()=>{\n  // base tap power\n  let power=state.tap.power * (1+decorVal('tapYield')) * (1+boostVal('tapPower')) * (1+boostVal('globalCredits'));\n  // crit?\n  const critChance= state.tap.critChance + decorVal('critChance') + boostVal('critChance');\n  const isCrit=Math.random()<critChance;\n  let gain=power;\n  if(isCrit){ gain*= state.tap.critMult; // drops\n    if(Math.random()<0.03) state.tickets+=1; // ticket drop\n    if(Math.random()<0.003) state.gems+=1; // gem drop\n  }\n  state.credits+=Math.round(gain);\n  // combo\n  state.tap.combo=Math.min(50, state.tap.combo+1);\n  // popup\n  const p=document.createElement('div'); p.className='popup'+(isCrit?' crit':''); p.textContent='+'+Math.round(gain); flowerEl.appendChild(p); setTimeout(()=>p.remove(),500);\n  save(); refreshTop(); renderCombo();\n});\n\n// combo passive decay\nsetInterval(()=>{ state.tap.combo=Math.max(0, state.tap.combo-1); renderCombo(); }, 1000);\n\n// --- PANELS --------------------------------------------------------------\nfunction buildPanels(){\n  // Seeds\n  const ps=$('#panel-seeds'); ps.innerHTML=''; DATA.seeds.forEach(s=>{ const card=document.createElement('div'); card.className='card'; card.innerHTML=`<h4>${s.spr} ${s.name}</h4><div class=\"meta\">${s.cost}\ud83d\udcb0 \u00b7 ${s.grow}s \u00b7 y${s.yield}</div><div class=\"meta\">Tap a plot to plant</div>`; ps.appendChild(card); });\n  // Upgrades (simple linear buttons)\n  const pu=$('#panel-upgrades'); pu.innerHTML='';\n  const ups=[\n    {key:'tapPower', label:'Tap Power +1', price:()=>DATA.upgrades.tapPower.base * Math.pow(DATA.upgrades.tapPower.scale, state.upgrades.tapPower)},\n    {key:'critChance', label:'+1% Crit', price:()=>DATA.upgrades.critChance.base * Math.pow(DATA.upgrades.critChance.scale, state.upgrades.critChance)},\n    {key:'critMult', label:'+2x Crit Mult', price:()=>DATA.upgrades.critMult.base * Math.pow(DATA.upgrades.critMult.scale, state.upgrades.critMult)}\n  ];\n  ups.forEach(u=>{ const btn=document.createElement('button'); btn.className='card buy'; const cost=u.price()|0; btn.innerHTML=`<h4>${u.label}</h4><div class=\"meta\">${cost}\ud83d\udcb0</div>`; btn.onclick=()=>{ if(state.credits<cost) return; state.credits-=cost; state.upgrades[u.key]++; if(u.key==='tapPower') state.tap.power+=1; if(u.key==='critChance') state.tap.critChance+=0.01; if(u.key==='critMult') state.tap.critMult+=2; save(); renderAll(); }; pu.appendChild(btn); });\n  // Decor\n  const pd=$('#panel-decor'); pd.innerHTML=''; DATA.decor.forEach(d=>{ const btn=document.createElement('button'); btn.className='card buy'; btn.innerHTML=`<h4>${d.spr} ${d.name}</h4><div class=\"meta\">${d.cost} ${d.currency==='gems'?'\ud83d\udc8e':'\ud83d\udcb0'}</div>`; btn.onclick=()=>{ if(d.currency==='gems'){ if(state.gems<d.cost) return; state.gems-=d.cost; } else { if(state.credits<d.cost) return; state.credits-=d.cost; } state.decor.push(d); save(); renderAll(); }; pd.appendChild(btn); });\n  // Boosters\n  const pb=$('#panel-boosters'); pb.innerHTML=''; DATA.boosters.forEach(b=>{ const btn=document.createElement('button'); btn.className='card buy'; btn.innerHTML=`<h4>${b.name}</h4><div class=\"meta\">${b.tickets} \ud83c\udf9f\ufe0f \u00b7 ${b.dur}s</div>`; btn.onclick=()=>{ if(state.tickets<b.tickets) return; state.tickets-=b.tickets; state.boosters[b.id]= (Date.now()/1000) + b.dur; save(); renderAll(); }; pb.appendChild(btn); });\n}\n\n// --- NAV ---------------------------------------------------------------\n$$('.dock-btn').forEach(b=> b.addEventListener('click',()=>{ $$('.dock-btn').forEach(x=>x.classList.remove('active')); b.classList.add('active'); const tab=b.dataset.tab; $$('.panel').forEach(p=>p.classList.remove('active')); $('#panel-'+tab).classList.add('active'); }));\n\n// --- SETTINGS -----------------------------------------------------------\n$('#btnSettings').onclick=()=>$('#settings').showModal();\n$('#resetBtn').onclick=()=>{ localStorage.removeItem('igr-save'); location.reload(); };\n\n// --- LOOP ---------------------------------------------------------------\nfunction tick(){\n  // auto harvest (if we add later as upgrade; for now manual)\n  // boosters cleanup visual (no-op here)\n  renderAll(); requestAnimationFrame(tick);\n}\n\n// --- INIT ---------------------------------------------------------------\nload(); buildPlots(); buildPanels(); renderAll(); requestAnimationFrame(tick);\n"
    }
  ]
}